{% extends 'TooBigAppBundle::page-with-header.html.twig' %}

{% block title %}Редактирование объявления "{{ posting.title }}"{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="/bundles/toobigapp/css/jquery.fileupload-ui.css" rel="stylesheet">
{% endblock stylesheets %}


{% block page_header %}
    {% block crumbs %}
        <div class="breadcrumbs">
            <span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb" class="breadcrumbs-item"><a href="{{ rpath ('/') }}" class="breadcrumbs-item-link link" itemprop="url"><span itemprop="title">Главная</span></a></span>
            <span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb" class="breadcrumbs-item"><a itemprop="url" class="breadcrumbs-item-link link"><span itemprop="title">Редактирование объявления</span></a></span>
        </div>
    {% endblock crumbs %}
{% endblock page_header %}





{% block page_body %}
    {% for flashMessage in app.session.flashbag.get('notice') %}

    {{ flashMessage }}

    {% endfor %}

    {# Underscore templates for the uploader #}
    {% include "TooBigAppBundle:Item\\FileUpload:templates.html.twig" %}
    {% form_theme form.color 'TooBigAppBundle:Form:colorpicker_fields.html.twig' %}

    <form name="Item" class="edit-form form-horizontal form-2-section" action="{{ path('app_item_edit', { item_id: posting.id, editId: editId }) }}" method="post" {{ form_enctype(form) }}>

    <div class="form-group control-group">
        <label for="Item_rubric" class="col-sm-3 control-label">{{ 'Рубрика'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">
            {% if breadcrumbs is defined %}
                {% for rub in breadcrumbs %}
                    <span class="breadcrumbs-item"><a href="{{ entitypath(rub) }}" class="breadcrumbs-item-link link"><span>{{ rub }}</span></a></span>
                {% endfor %}
            {% endif %}
        </div>
    </div>

    <div class="form-group control-group separator"></div>

    <h3>Контактная информация</h3>

    <div class="form-group control-group">
        <label for="Item_phone" class="col-sm-3 control-label">{{ 'Телефон'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-8">{{ form_widget(form.phone, {'value': posting.phone != '' ? posting.phone : app.user.phone, 'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group">
        <label for="Item_place" class="col-sm-3 control-label">{{ 'Местонахождение'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-8">{{ form_widget(form.place, {'value': posting.place != '' ? posting.place : app.user.place, 'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group separator"></div>

    <h3>Объявление</h3>

    <div class="form-group control-group">
        <label for="Item_title" class="col-sm-3 control-label">{{ 'Название объявления'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">{{ form_widget(form.title, {'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group">
        <label for="Item_content" class="col-sm-3 control-label">{{ 'Описание объявления'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">{{ form_widget(form.content, {'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group separator"></div>

    <h3>Характеристики</h3>

    <div class="form-group control-group">
        <label for="Item_gender" class="col-sm-3 control-label">{{ 'Пол'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">{{ form_widget(form.gender, {'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group">
        <label for="Item_color" class="col-sm-3 control-label">{{ 'Цвет'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">{{ form_widget(form.color, {'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group">
        <label for="Item_brand" class="col-sm-3 control-label">{{ 'Бренд/Модель'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">
            <span>{{ posting.brand | raw }}
            {% if posting.model is defined and posting.model is not null %} / {{ posting.model | raw }}{% endif %}
            </span>
        </div>
    </div>

    <div class="form-group control-group">
        <label for="Item_size_type" class="col-sm-3 control-label">{{ 'Размер/Тип'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">
            {% if posting.size is defined and posting.size is not null %}
                <span>{{ posting.size | raw }}</span> ( <span>{{ posting.sizeType | raw }}</span> )
            {% endif %}
        </div>
    </div>

    <div class="form-group control-group">
        <label for="Item_status" class="col-sm-3 control-label">{{ 'Состояние вещи'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-8">{{ form_widget(form.status, {'attr': {'class':'status form-control'}}) }}</div>
    </div>

    <div class="form-group control-group">
        <label for="Item_price" class="col-sm-3 control-label">{{ 'Стоимость'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-9">
            {{ form_widget(form.price, {'attr': {'class':'form-control'}}) }}
            {% image '@TooBigAppBundle/Resources/public/images/rub.png' %}
            <img src="{{ asset_url }}" class="ico-roubles"/>
            {% endimage %}
        </div>
    </div>

    {# Hydrated by javascript #}
    <div class="file-uploader"></div>

    <div class="form-group control-group separator"></div>

    <h3>Время размещения</h3>

    <div class="form-group control-group">
        <label for="Item_place" class="col-sm-3 control-label">{{ 'Размещать до'|trans({}, 'SonataUserBundle') }}</label>
        <div class="col-sm-8">{{ form_widget(form.publication_date_end, {'attr': {'class':'form-control'}}) }}</div>
    </div>

    <div class="form-group control-group separator"></div>

    <div class="form-group control-group">
        <div class="col-sm-12 form-buttons">
            {{ form_widget(form.save) }}{{ form_widget(form.reset) }}
        </div>
    </div>

    {{ form_end(form) }}

    <script type="text/javascript">

        // Enable the file uploader

        $(function() {
            new PunkAveFileUploader({
                'uploadUrl': {{ path('app_file_upload', { editId: editId }) | json_encode | raw }},
                'viewUrl': {{ ('/uploads/tmp/attachments/' ~ editId) | json_encode | raw }},
                'el': '.file-uploader',
                'existingFiles': {{ punkave_get_files('tmp/attachments/' ~ editId) | json_encode | raw }},
                'delaySubmitWhileUploading': '.edit-form'
            });
        });
    </script>

{% endblock page_body %}